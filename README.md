# iPhone as a pentest tool
## Use your iPhone as a pentest tool with the following steps:
###### This assumes you are working as a team, 1 tiger team physical pentester and 1 remote pentester
###### * please see demo.pdf for walkthrough

**Tiger team preparation steps**
1. Jailbreak phone
2. App store - install WireGuard / Configure WireGuard tunnel (to your VPS)
3. Install Cydia via checkra1n jailbreak app
4. Install OpenSSH, network commands, socat and wifiutil from Cydia
5. Start WireGuard tunnel, toss into your pocket and approach your wireless AP target

**Remote pentester steps**
1. SSH into iPhone
2. Conduct `wifiutil scan` repeatedly until you find your target AP  
3. Prestage a static route to your VPS on the iPhone. *(This prevents your "WireGuard -> VPS traffic" from traversing the target network)*  
`route -n add -net X.X.X.X/32 Y.Y.Y.Y` where X=VPS_IP and Y=Cellular_network_next_hop (run `netstat -rn` to determine what your next hop is)  
4. Alternatively, you can pop a second SSH terminal to the iPhone and stage a command to delete the default route that will appear when you associate over WiFi. *(warning you have to be quick, otherwise run the following command)*  
`while true; do route -n delete default -interface en0; done` *where en0 is the default wifi interface on the iPhone*  
5. Associate the iPhone to wireless AP  
`wifiutil associate WIFI_AP -p WIFI_AP_PASSWORD`  
6. Discover your ip address on the wireless LAN and determine router IP (or other host of interest, i.e. web server, client, etc.)  
`ifconfig` and `arp -a`  
7. Launch socat on the iPhone
`socat TCP-LISTEN:8888,fork TCP:UPSTREAM_IP:PORT`  
*if you are trying to interact with a router IP you may do something similar to `socat TCP-LISTEN:80,fork TCP:192.168.0.1:80`*
8. Interact with target IP's from the remote pentester's workstation.

Summary: Remote Pentester \<wireguard tunnel\> **VPS** \<wireguard tunnel\> iPhone \<WiFi\> Target client
